import requests
import re
import urllib.parse

# Função para obter todos os links de uma página
def get_links(url):
    try:
        r = requests.get(url)
        return re.findall('(?:href=")(.*?)"', r.text)
    except requests.exceptions.RequestException as e:
        print(e)

def find_xss(url):
    payloads = ['<script>alert("XSS")</script>', '<img src="javascript:alert(\'XSS\')" />']

    for payload in payloads:
        try:
            r = requests.get(url.replace('PARAM', urllib.parse.quote(payload)))
            if payload in r.text:
                print(f"Vulnerabilidade de XSS detectada em {url} com payload: {payload}")
        except requests.exceptions.RequestException as e:
            print(e)

url = input("Insira a URL do alvo: ")

links = get_links(url)

for link in links:
    if 'http' not in link:
        link = url + '/' + link
    if 'PARAM' in link:
        find_xss(link)
