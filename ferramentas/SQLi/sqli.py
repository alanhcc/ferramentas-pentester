import argparse
import requests

def sql_injection_test(url, payloads, verbose=False):
    for payload in payloads:
        response = requests.get(url + payload)
        if response.status_code == 200 and "error" in response.text.lower():
            print(f"O site é vulnerável a ataques de injeção de SQL com o payload: {payload}")
            if verbose:
                print(response.text)
        else:
            print(f"O site não é vulnerável a ataques de injeção de SQL com o payload: {payload}")

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('-u', '--url', help='target URL')
    parser.add_argument('-p', '--payloads', nargs='+', default=["'"])
    parser.add_argument('-v', '--verbose', action='store_true')
    args = parser.parse_args()

    if not args.url:
        url = input("Digite a URL de destino: ")
    else:
        url = args.url

    sql_injection_test(url, args.payloads, args.verbose)
