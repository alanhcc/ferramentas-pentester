import requests
import re

def extract_tokens(url):
    response = requests.get(url)
    tokens = re.findall(r"<input type='hidden' name='csrf_token' value='(.*?)'>", response.text)
    if len(tokens) == 0:
        print("[!] Nenhum token encontrado na pÃ¡gina.")
    return tokens

def test_csrf_vulnerability(url, csrf_token):
    data = {
        'username': 'malicious_user',
        'password': 'password123',
        'csrf_token': csrf_token
    }
    response = requests.post(url, data=data)
    if response.status_code == 200:
        print("[+] Vulnerabilidade de CSRF detectada em", url)
    else:
        print("[-] Nenhuma vulnerabilidade de CSRF detectada em", url)

target_url = 'http://example.com'

tokens = extract_tokens(target_url)

for token in tokens:
    test_csrf_vulnerability(target_url, token)


